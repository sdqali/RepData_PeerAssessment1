---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
## Loading and preprocessing the data
```{r}
activity <- read.csv("activity.csv")
activity$date <- as.Date(activity$date,"%Y-%m-%d")
```

## What is mean total number of steps taken per day?

Load libraries
```{r}
library(plyr)
library(ggplot2)
```

Aggregate data per day

```{r}
perDay <- ddply(activity, 
                "date",
                summarise, 
                totalSteps = sum(steps, na.rm = TRUE))
```

Compute mean
```{r}
meanSteps <- mean(perDay$totalSteps, na.rm = TRUE)
meanSteps
```

Compute median
```{r}
medianSteps <- median(perDay$totalSteps, na.rm = TRUE)
medianSteps
```

Plot a histogram
```{r}
qplot(perDay$totalSteps, 
      geom = "histogram", 
      bins = 50,
      main = "Distribution of steps per day",
      xlab = "Total steps per day",
      ylab = "Count") +
  geom_vline(xintercept = meanSteps, colour = "blue") +
  geom_text(mapping=aes(x = meanSteps,
                        y = 7,
                        label = paste("Mean = ", round(meanSteps, digits = 2))),
            size = 4,
            angle = 90,
            vjust = -0.4,
            hjust = 0) + 
  geom_vline(xintercept = medianSteps, colour = "green") +
  geom_text(mapping=aes(x = medianSteps,
                        y = 7,
                        label = paste("Median = ", round(medianSteps, digits = 2))),
            size = 4,
            angle = 90,
            vjust = -0.4,
            hjust = 0)
```

## What is the average daily activity pattern?

Aggregate by intervals
```{r}
byInterval <- ddply(activity, 
                    "interval",
                    summarise, 
                    mean = mean(steps, na.rm = TRUE), total = sum(steps, na.rm = TRUE))
```
Plot a time series
```{r}
ggplot(data = byInterval, aes(x = interval, y = mean)) +
  geom_line(color = "#97CF84") +
  ggtitle("Average steps per interval") +
  xlab("Interval") +
  ylab("Average steps")
```

Find 5 minute interval with maximum number of steps on average
```{r}
byInterval[which.max(byInterval$mean), ]
```

## Imputing missing values

Calculate the total number of missing values in the dataset

```{r}
missing <- subset(activity, is.na(steps) | is.na(date) | is.na(interval))
nrow(missing)
```

## Are there differences in activity patterns between weekdays and weekends?
